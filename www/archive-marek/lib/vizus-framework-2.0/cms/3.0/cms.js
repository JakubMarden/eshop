if(!vizus){throw new Error("Chybí system.js")}if(!jQuery){throw new Error("Chybí jquery.js")}jQuery.fn.draggable=function(a){var b=$(a);this.mousedown(function(g){var h=b.offset();var c=$(window.document.createElement("div"));c.css({position:"fixed",zIndex:b.css("zIndex")+1});c.offset(h);c.width(b.outerWidth()).height(b.outerHeight());c.appendTo(b);var f=g.pageX-h.left;var d=g.pageY-h.top;$(window).bind("mousemove.draggable",function(j){var i={left:j.pageX-f,top:j.pageY-d};b.offset(i);c.offset(i)});$(window).bind("mouseup.draggable",function(i){$(window).unbind("mousemove.draggable");$(window).unbind("mouseup.draggable");c.remove()});vizus.event.stop(g.originalEvent)});return this};jQuery.fn.outerHTML=function(){return $(this).clone().wrap("<div>").parent().html()};if(!vizus.cms){vizus.cms={}}vizus.cms.status={zIndex:60000,messageBoxInstances:[],overlayInstances:[],dialogInstances:[]};vizus.cms.changeLanguage=function(d,a,j){var b="";var f={};f[a]=d;var e=document.getElementById("Module").contentWindow;var l=e.document.location.toString();var h=true;var c=l.substr(l.indexOf("?")+1).split("&");for(var g=0;g<c.length;g++){var k=c[g].split("=");if(k[0]=="type"||k[0]=="cmsSID"||k[0]=="cmd"||k[0]==a){continue}h=false;break}if(h){b=l}else{b=j}e.document.location=vizus.url.replace(b,{query:f});window.focus()};vizus.cms.MessageBox=function(m,h,j,c){this.message=m||"Message";this.buttons=h||[{name:vizus.i18n.text("OK")}];this.opener=j||window;this.context=c||top;this.stack=top.vizus.cms.status.messageBoxInstances;this.stack.push(this);this.index=this.stack.length-1;this.overlay=new vizus.cms.page.Overlay("light",this.context);this.x=null;this.y=null;this.id="MessageBox"+this.index;this.box=top.$("#MessageBox").clone();this.box.attr("id",this.id);this.box.css({zIndex:this.context.vizus.cms.status.zIndex++,display:"table"});this.box.find("pre.message").text(this.message);this.active=null;var k=function(i){return function(n){this.close();if(typeof i=="function"){i()}}};var h=this.box.find("div.buttons");for(var e=0;e<this.buttons.length;e++){var d=this.buttons[e];var b=typeof d.name=="string"?d.name:"Button";var f=this.context.document.createElement("button");f.className=typeof d["class"]=="string"?d["class"]:"";f.onclick=k(d.onclick).bind(this);if(b.indexOf("&")!=-1){this.buttons[e].key=b.match(/&(\w)/)[1];$(f).html(b.replace(/&(\w)/,"<u>$1</u>"))}else{$(f).text(b)}h.append(f)}this.box.appendTo(this.context.document.body);this.width=this.box.width();this.height=this.box.height();this.viewport={width:this.context.innerWidth,height:this.context.innerHeight};this.margin={width:this.box.outerWidth(true)-this.box.width(),height:this.box.outerHeight(true)-this.box.height()};this.centre();this.box.css({visibility:"visible"});var a=function(i){this.viewport={width:this.context.innerWidth,height:this.context.innerHeight};this.centre()};var g=function(p){if(vizus.event.keyCode(p.originalEvent)==vizus.event.keys.keyEsc){this.close()}var o=vizus.event.keyChar(p.originalEvent);if(typeof o=="string"&&o.length==1){for(var n=0;n<this.buttons.length;n++){if(this.buttons[n].key==o){this.close();if(typeof this.buttons[n].onclick=="function"){this.buttons[n].onclick()}break}}}};var l=function(){this.active=this.opener.document.activeElement;this.box.find("button:first").focus()};$(this.context).on("resize.vizus.cms."+this.id,a.bind(this));$(this.context.document).on("keydown.vizus.cms."+this.id,g.bind(this));this.context.setTimeout(l.bind(this),10)};vizus.cms.MessageBox.prototype.centre=function(){this.x=Math.round(this.context.innerWidth/2-(this.width+this.margin.width)/2);this.y=Math.round(this.context.innerHeight/2-(this.height+this.margin.height)/2);this.box.css({left:this.x+"px",top:this.y+"px"});return this};vizus.cms.MessageBox.prototype.close=function(){this.remove()};vizus.cms.MessageBox.prototype.remove=function(){$(this.context).off("resize.vizus.cms."+this.id);$(this.context.document).off("keydown.vizus.cms."+this.id);this.stack.splice(this.index,1);this.box.remove();this.overlay.remove();this.context.vizus.cms.status.zIndex--;if(this.active){this.active.focus()}};vizus.cms.alert=function(d,a){var c=[{name:vizus.i18n.text("OK"),onclick:a}];var b=new vizus.cms.MessageBox(d,c,window,top)};vizus.cms.confirm=function(c,d,e){var b=[{name:vizus.i18n.text("&Ano"),onclick:d},{name:vizus.i18n.text("&Ne"),"class":"second",onclick:e}];var a=new vizus.cms.MessageBox(c,b,window,top);return false};vizus.cms.confirmClick=function(e,d,f,g){vizus.event.stop(e);var a=function(){if(typeof f=="function"){f()}switch(vizus.getClass(e.target)){case"HTMLAnchorElement":(e.target.target=="_top"?top:window).document.location=e.target.href;break;case"HTMLInputElement":switch(e.target.type){case"checkbox":e.target.checked=!e.target.checked;break;case"submit":if(typeof e.target.form.onsubmit!="function"||e.target.form.onsubmit()){e.target.type="hidden";e.target.form.submit()}break}break}if(typeof g=="function"){g()}};var c=[{name:vizus.i18n.text("&Ano"),onclick:a},{name:vizus.i18n.text("&Ne"),"class":"second"}];var b=new vizus.cms.MessageBox(d,c,window,top);return false};if(!vizus.cms.page){vizus.cms.page={}}vizus.cms.page.init=function(a,b){var d=a.split(/\s+/);for(var f=0;f<d.length;f++){switch(d[f]){case"login":try{if(window.opener){window.opener.top.location=window.location;window.close()}else{if(window.top.location!=window.document.location){window.top.location=window.location}}}catch(c){}$(document).ready(function(){$("#Form").css("visibility","visible");$("#Login").get(0).focus()});break;case"main":$(document).ready(function(){$("ul.menu").find("li.closed > ul").css("display","none");$("ul.menu").find('a[target="module"]').on("click",function(){$("ul.menu a.active").removeClass("active");$(this).addClass("active")});$("ul.menu a").not('[class*="icon"]').addClass("icon-module");$("ul.menu").find("span.node").on("click",function(){var j=$(this).parent();if(j.hasClass("opened")){j.removeClass("opened").addClass("closed").find("ul").eq(0).slideUp(200)}else{j.removeClass("closed").addClass("opened").find("ul").eq(0).slideDown(200)}});var i=$("#Left");var h=$("#Splitter");var g=$("#Right");var e=h.width();h.css("left",i.width()-e);h.mousedown(function(k){var j=new vizus.cms.page.Overlay("transparent");h.addClass("active");$(document).bind("mousemove.splitter",function(l){if(l.pageX>50&&l.pageX<500){i.css("width",l.pageX);h.css("left",l.pageX-e);g.css("left",l.pageX)}});$(window).bind("mouseup.splitter",function(l){h.removeClass("active");j.remove();$(document).unbind("mousemove.splitter");$(this).unbind("mouseup.splitter");document.cookie="CmsUserSettings[cms.menuWidth]="+parseInt(i.css("width"),10)});return false});$("#Module").on("load",function(){var j=this.contentWindow.document.location.toString();$('ul.menu a[target="module"]').each(function(){if(this.href==j&&!$(this).hasClass("active")){$("ul.menu a.active").removeClass("active");$(this).addClass("active")}})})});break;case"module":$(document).ready(function(){$("body.module > div.content").each(function(){if(b&&b.fullContent){$(this).addClass("full")}if($(this).hasClass("full")){$(this).find("div.cmd-line a.resize-left").parent().show()}else{$(this).find("div.cmd-line a.resize-right").parent().show()}});vizus.cms.wcom.reorder()});break;case"dialog":$(document).ready(function(){window.dialog=vizus.cms.dialog.resolve(window).init(window).title(document.title)});break}}};vizus.cms.page.resizeContent=function(){$("body.module > div.content").each(function(){if($(this).hasClass("full")){$(this).removeClass("full");$(this).find("div.cmd-line a.resize-left").parent().hide();$(this).find("div.cmd-line a.resize-right").parent().show()}else{$(this).addClass("full");$(this).find("div.cmd-line a.resize-left").parent().show();$(this).find("div.cmd-line a.resize-right").parent().hide()}})};vizus.cms.page.wait=function(c,b){if(c==undefined){c=true}b=b||window;var d=b.document.getElementById("Wait");if(c&&!d){var a=new vizus.cms.page.Overlay("light",b);d=b.document.createElement("DIV");d.id="Wait";d.className="wait";d.waitOverlay=a;d.waitAngle=0;d.waitTimer=b.setInterval(function(){d.waitAngle=d.waitAngle+10>360?0:d.waitAngle+10;var e="rotate("+d.waitAngle+"deg)";$(d).css({"-webkit-transform":e,transform:e})},27);b.document.body.appendChild(d)}else{if(!c&&d){d.waitOverlay.remove();b.clearInterval(d.waitTimer);b.document.body.removeChild(d)}}};vizus.cms.page.Overlay=function(c,b){this.className=c||"light";this.context=b||window;this.zIndex=this.context.vizus.cms.status.zIndex++;this.stack=this.context.vizus.cms.status.overlayInstances;this.stack.push(this);this.index=this.stack.length-1;for(var a=0;a<this.stack.length-1;a++){this.stack[a].hide()}this.div=this.context.document.createElement("DIV");this.div.id="Overlay"+this.index;this.div.className="overlay "+this.className;this.div.style.zIndex=this.zIndex;this.context.document.body.appendChild(this.div);this.show()};vizus.cms.page.Overlay.prototype.show=function(){if(this.div.style.display!="block"){this.div.style.display="block"}return this};vizus.cms.page.Overlay.prototype.hide=function(){if(this.div.style.display!="none"){this.div.style.display="none"}return this};vizus.cms.page.Overlay.prototype.remove=function(){this.context.document.body.removeChild(this.div);this.stack.splice(this.index,1);this.context.vizus.cms.status.zIndex--;if(this.stack.length>0){this.stack[this.stack.length-1].show()}};if(!vizus.cms.wcom){vizus.cms.wcom={}}vizus.cms.wcom.reorder=function(a){var c=$("body > div.content").first();var e=a||{top:parseInt(c.css("padding-top"),10)||0,bottom:parseInt(c.css("padding-bottom"),10)||0};var d=0;c.find("div.cmd-line.top, ul.path.top").each(function(){$(this).css("top",d+"px");d+=$(this).outerHeight(false)});var b=0;$(c.find("ul.list-pager.bottom, ul.list-select.bottom").get().reverse()).each(function(){$(this).css("bottom",b+"px");b+=$(this).outerHeight(false)});c.css({"padding-top":e.top+d+"px","padding-bottom":e.bottom+b+"px"});if(d+b>0&&!a){$(window).on("resize.vizus.cms.reorder",function(){vizus.cms.wcom.reorder(e)})}};if(!vizus.cms.wcom.list){vizus.cms.wcom.list={}}vizus.cms.wcom.list.filter=function(c,a){c=$.event.fix(c||window.event);var b={from:0};switch(c.target.tagName){case"INPUT":switch(c.target.type.toUpperCase()){case"TEXT":b[a]=c.target.value;if(c.type=="keydown"&&c.which==13){vizus.page.redirect({query:b})}else{if(c.type=="keydown"&&c.which==27){c.target.value="";c.target.focus()}}break;case"CHECKBOX":b[a]=c.target.checked?1:0;vizus.page.redirect({query:b});break}break;case"SELECT":b[a]=c.target.value?c.target.value:null;vizus.page.redirect({query:b});break}};vizus.cms.wcom.list.select=function(d,c,a){var b=document.getElementById(d+"Item"+c+"Selected");b.checked=!b.checked;vizus.cms.wcom.list.onchange(d,c);if(a){vizus.cms.wcom.listSelect.update(a,b.name)}};vizus.cms.wcom.list.onchange=function(d,c){var a=document.getElementById(d+"Item"+c+"Select");var b=document.getElementById(d+"Item"+c+"Selected");if(b.checked){$(a).addClass("icon-checked").removeClass("icon-unchecked")}else{$(a).removeClass("icon-checked").addClass("icon-unchecked")}};if(!vizus.cms.wcom.listTile){vizus.cms.wcom.listTile={}}vizus.cms.wcom.listTile.select=function(d){var c=vizus.dom.get(d);var b=$(c).find("input.selected").get(0);var a=$(c).data("list-select-id");b.checked=!b.checked;vizus.cms.wcom.listTile.onchange(d);if(a){vizus.cms.wcom.listSelect.update(a,b.name)}};vizus.cms.wcom.listTile.onchange=function(d){var c=vizus.dom.get(d);var a=$(c).find("a.select").get(0);var b=$(c).find("input.selected").get(0);if(b.checked){$(a).addClass("icon-checked").removeClass("icon-unchecked");$(c).addClass("selected");vizus.cms.dragdrop.disableDrop(c)}else{$(a).removeClass("icon-checked").addClass("icon-unchecked");$(c).removeClass("selected");vizus.cms.dragdrop.enableDrop(c)}};if(!vizus.cms.wcom.listSelect){vizus.cms.wcom.listSelect={}}vizus.cms.wcom.listSelect.NONE=false;vizus.cms.wcom.listSelect.ALL=true;vizus.cms.wcom.listSelect.INVERT=null;vizus.cms.wcom.listSelect.select=function(e,b,d){var a=document.getElementsByName(b);for(var c=0;c<a.length;c++){a[c].checked=d===null?!a[c].checked:d;if(typeof a[c].onchange=="function"){typeof a[c].onchange()}}vizus.cms.wcom.listSelect.update(e,b)};vizus.cms.wcom.listSelect.all=function(b,a){vizus.cms.wcom.listSelect.select(b,a,vizus.cms.wcom.listSelect.ALL)};vizus.cms.wcom.listSelect.none=function(b,a){vizus.cms.wcom.listSelect.select(b,a,vizus.cms.wcom.listSelect.NONE)};vizus.cms.wcom.listSelect.invert=function(b,a){vizus.cms.wcom.listSelect.select(b,a,vizus.cms.wcom.listSelect.INVERT)};vizus.cms.wcom.listSelect.check=function(e,c){var b=document.getElementById(e+"Operation");var a=document.getElementsByName(c);if(b&&!b.value){return false}for(var d=0;d<a.length;d++){if(a[d].checked){return true}}return false};vizus.cms.wcom.listSelect.update=function(f,c){var a=document.getElementById(f+"Counter");if(!a){return}var b=document.getElementsByName(c);var e=0;for(var d=0;d<b.length;d++){if(b[d].checked){e++}}$(a).text(e)};if(!vizus.cms.wcom.order){vizus.cms.wcom.order={}}vizus.cms.wcom.order.onkeydown=function(b,c){b=b||window.event;var a=vizus.event.keys;switch(b.keyCode){case a.keyPageUp:vizus.cms.wcom.order.jump(c,-10);break;case a.keyPageDown:vizus.cms.wcom.order.jump(c,10);break;case a.keyUp:vizus.cms.wcom.order.up(c);break;case a.keyDown:vizus.cms.wcom.order.down(c);break;case a.keyHome:vizus.cms.wcom.order.first(c);break;case a.keyEnd:vizus.cms.wcom.order.last(c);break;default:return}vizus.event.stop(b);return false};vizus.cms.wcom.order.first=function(c){var a=vizus.dom.get(c+"Order");if(a.selectedIndex>0){var b=vizus.dom.moveTo(a.options[a.selectedIndex],0);vizus.cms.wcom.order.update(c,b)}};vizus.cms.wcom.order.jump=function(d,b){var a=vizus.dom.get(d+"Order");if(a.selectedIndex!=-1){var c=vizus.dom.moveBy(a.options[a.selectedIndex],b);vizus.cms.wcom.order.update(d,c)}};vizus.cms.wcom.order.up=function(c){var a=vizus.dom.get(c+"Order");if(a.selectedIndex>0){var b=vizus.dom.moveBy(a.options[a.selectedIndex],-1);vizus.cms.wcom.order.update(c,b)}};vizus.cms.wcom.order.down=function(c){var a=vizus.dom.get(c+"Order");if(a.selectedIndex!=-1){var b=vizus.dom.moveBy(a.options[a.selectedIndex],1);vizus.cms.wcom.order.update(c,b)}};vizus.cms.wcom.order.last=function(c){var a=vizus.dom.get(c+"Order");if(a.selectedIndex!=-1){var b=vizus.dom.moveTo(a.options[a.selectedIndex],-1);vizus.cms.wcom.order.update(c,b)}};vizus.cms.wcom.order.update=function(f,d){var b=[];var a=vizus.dom.get(f+"Order");var e=vizus.dom.get(f+"Set");for(var c=0;c<a.options.length;c++){b.push(a.options[c].value+"="+c)}e.value=b.join(",");if(/firefox/i.test(window.navigator.userAgent)&&d){window.setTimeout(function(){d.selected=true},1)}};if(!vizus.cms.wcom.galleryChange){vizus.cms.wcom.galleryChange={}}vizus.cms.wcom.galleryChange.remove=function(b,a){$("#"+b+"Item"+a).addClass("removed");$("#"+b+"Item"+a+"Removed").val(1)};vizus.cms.wcom.galleryChange.renew=function(b,a){$("#"+b+"Item"+a).removeClass("removed");$("#"+b+"Item"+a+"Removed").val(0)};if(!vizus.cms.form){vizus.cms.form={}}if(!vizus.cms.form.gps){vizus.cms.form.gps={}}vizus.cms.form.gps.select=function(b,k,a){var e=Math.floor(k);var l=Math.floor(60*(k-e));var i=Math.floor(3600*(k-e-l/60));var f=k+"°";var j=e+"° "+l+"′ "+i+"″";var h=Math.floor(a);var d=Math.floor(60*(a-h));var m=Math.floor(3600*(a-h-d/60));var c=a+"°";var g=h+"° "+d+"′ "+m+"″";$("#"+b).val(k+","+a);$("#"+b+"Latitude60").text(j);$("#"+b+"Latitude10").text("("+f+")");$("#"+b+"Latitude").show();$("#"+b+"Longitude60").text(g);$("#"+b+"Longitude10").text("("+c+")");$("#"+b+"Longitude").show();$("#"+b+"None").hide()};vizus.cms.form.gps.remove=function(a){$("#"+a).val("");$("#"+a+"Latitude60").empty();$("#"+a+"Latitude10").empty();$("#"+a+"Latitude").hide();$("#"+a+"Longitude").hide();$("#"+a+"Longitude60").empty();$("#"+a+"Longitude10").empty();$("#"+a+"None").show()};vizus.cms.form.gps.googleMapInitialize=function(c,a,h,g,d,j){j=j||{zoom:7,center:new google.maps.LatLng(50.081572,14.427066),mapTypeId:google.maps.MapTypeId.ROADMAP};if(h){var f=h.toString().match(/^(\d+(?:\.\d+)?),(\d+(?:\.\d+)?)$/);if(f){j.center=new google.maps.LatLng(f[1],f[2])}}var b=new google.maps.Map(document.getElementById(c),j);var e=new google.maps.Marker({position:b.getCenter(),map:b});b.controls[google.maps.ControlPosition.TOP_LEFT].push(document.getElementById(a));var i=new google.maps.places.SearchBox(document.getElementById(a));google.maps.event.addListener(b,"click",function(k){h=k.latLng;e.setPosition(h);g.vizus.cms.form.gps.select(d,h.lat(),h.lng())});google.maps.event.addListener(i,"places_changed",function(){var l=i.getPlaces();var n=new google.maps.LatLngBounds();for(var m=0,k;k=l[m];m++){n.extend(k.geometry.location)}b.fitBounds(n)})};if(!vizus.cms.form.password){vizus.cms.form.password={}}vizus.cms.form.password.generate=function(b,a){document.getElementById(b).value=vizus.text.password(a);vizus.cms.form.password.check(b)};vizus.cms.form.password.check=function(g){var e=[];var a=document.getElementById(g).value;for(var b=0;b<10;b++){e[b]=document.getElementById(g+"Level"+b);e[b].className=e[b].className.replace(/ level\d+/,"")}if(a.length>0){var d=null;var c=0;if((d=a.match(/[a-z]/g))!=null){c+=4.7*d.length}if((d=a.match(/[A-Z]/g))!=null){c+=4.705*d.length}if((d=a.match(/[0-9]/g))!=null){c+=3.33*d.length}if((d=a.match(/\W/g))!=null){c+=4*d.length}if((d=a.match(/[\u00C0-\uFFFF]/g))!=null){c+=16*d.length}var f=Math.round(c/6);for(var b=0;b<f&&b<10;b++){e[b].className+=" level"+b}}};if(!vizus.cms.form.tabs){vizus.cms.form.tabs={}}vizus.cms.form.tabs.select=function(b,a){$("#"+b+"Tabs > li > a.active").removeClass("active");$("#"+b+"Tab"+a+" > a").addClass("active");$("#"+b+"Blocks > div > div").hide();$("#"+b+"Block"+a).show()};if(!vizus.cms.form.multiselect){vizus.cms.form.multiselect={}}vizus.cms.form.multiselect.toggleItem=function(c,b){var a=document.getElementById(c).options;a[b].selected=!a[b].selected;$("#"+c+"Container > ul.items li:eq("+b+") > a.item").toggleClass("active icon-checked icon-unchecked");$("#"+c+"Container > ul.items li:eq("+b+") ul li > a.item").each(function(d,e){a[b+d+1].selected=a[b].selected;if(a[b].selected){$(this).addClass("active icon-checked").removeClass("icon-unchecked")}else{$(this).addClass("icon-unchecked").removeClass("active icon-checked")}});vizus.cms.form.multiselect.update(c)};vizus.cms.form.multiselect.toggleChildren=function(b,a){$("#"+b+"Container > ul.items li:eq("+a+") > ul:visible").slideUp(200);$("#"+b+"Container > ul.items li:eq("+a+") > ul:hidden").slideDown(200);$("#"+b+"Container > ul.items li:eq("+a+") > a.children").toggleClass("icon-plus icon-minus")};vizus.cms.form.multiselect.selectGroup=function(d,b){var a=document.getElementById(d).options;for(var c=0;c<a.length;c++){if(b.indexOf(c)!=-1){a[c].selected=true;$("#"+d+"Item"+c+" > a.item").addClass("active icon-checked").removeClass("icon-unchecked")}else{a[c].selected=false;$("#"+d+"Item"+c+" > a.item").addClass("icon-unchecked").removeClass("active icon-checked")}}vizus.cms.form.multiselect.update(d)};vizus.cms.form.multiselect.update=function(d){var c=0;var a=document.getElementById(d).options;for(var b=0;b<a.length;b++){if(a[b].selected){c++}}$("#"+d+"Counter").text(c+" / "+a.length)};if(!vizus.cms.form.textarea){vizus.cms.form.textarea={}}vizus.cms.form.textarea.onkeypress=function(c,d,b){if(b<=0){return}var a=document.getElementById(d);if(a.value.length>b){vizus.event.stop(c);return false}};vizus.cms.form.textarea.onpaste=function(c,e,b){if(b<=0){return}var d=vizus.event.clipboard(c);var a=document.getElementById(e);if(d!==false&&a.value.length<b){if(a.value.length+d.length<=b){window.setTimeout('vizus.cms.form.textarea.update("'+e+'")',50);return}a.value+=d.substr(0,b-a.value.length);vizus.cms.form.textarea.update(e)}vizus.event.stop(c);return false};vizus.cms.form.textarea.update=function(a){$("#"+a+"Counter").text(document.getElementById(a).value.length)};if(!vizus.cms.form.file){vizus.cms.form.file={}}vizus.cms.form.file.select=function(d,a,c){var b=window[d+"Files"][a];if(b){window.opener.$("#"+d).val(b.id);window.opener.$("#"+d+"Link").html(b.link).show();window.opener.$("#"+d+"Info").html("("+b.size+", "+b.date+")").show();window.opener.$("#"+d+"None").hide();if(c){window.opener.$("#"+c).val(b.name)}}else{vizus.cms.form.file.remove(d)}if(window.dialog!=undefined&&window.dialog.close!=undefined){window.dialog.close()}else{window.close()}};vizus.cms.form.file.set=function(c,b,a){if(b){$("#"+c).val(b.id);$("#"+c+"Link").html(b.link).show();$("#"+c+"Info").html("("+b.size+", "+b.date+")").show();$("#"+c+"None").hide();if(a){$("#"+a).val(b.name)}}else{vizus.cms.form.file.remove(c)}};vizus.cms.form.file.remove=function(a){$("#"+a).val(0);$("#"+a+"Link").hide();$("#"+a+"Info").hide();$("#"+a+"None").show()};if(!vizus.cms.form.fileList){vizus.cms.form.fileList={}}vizus.cms.form.fileList.select=function(d,b,a){var c=window[d+"Files"][a];if(c){window.opener[d+"Ids"][b]=c.id;vizus.cms.form.fileList.update(d,window.opener);window.opener.$("#"+d+"Row"+b).attr("data-id",c.id);window.opener.$("#"+d+"Link"+b).html(c.link).show();window.opener.$("#"+d+"Info"+b).html("("+c.size+", "+c.date+")").show();window.opener.$("#"+d+"None"+b).hide();if(window.opener.$("#"+d+"Container li[data-id=0]:visible").length==0){window.opener.$("#"+d+"Container li:not(:visible)").eq(0).show()}}else{vizus.cms.form.fileList.remove(d,b)}window.close()};vizus.cms.form.fileList.set=function(e,c){var a=0;for(var d=0;d<c.length;d++){var b=c[d];outer:while(window[e+"Ids"][a]){a++;if($("#"+e+"Row"+a).length==0){break outer}}window[e+"Ids"][a]=b.id;$("#"+e+"Row"+a).attr("data-id",b.id);$("#"+e+"Link"+a).html(b.link).show();$("#"+e+"Info"+a).html("("+b.size+", "+b.date+")").show();$("#"+e+"None"+a).hide();if($("#"+e+"Container li[data-id=0]:visible").length==0){$("#"+e+"Container li:not(:visible)").eq(0).show()}}vizus.cms.form.fileList.update(e,window)};vizus.cms.form.fileList.remove=function(b,a){window[b+"Ids"][a]=null;vizus.cms.form.fileList.update(b,window);$("#"+b+"Row"+a).attr("data-id",0);$("#"+b+"Link"+a).hide();$("#"+b+"Info"+a).hide();$("#"+b+"None"+a).show();if($("#"+b+"Container li[data-id=0]:visible").length>1){$("#"+b+"Row"+a).hide()}};vizus.cms.form.fileList.update=function(e,b){var c=[];var d=b[e+"Ids"];for(var a=0;a<d.length;a++){if(d[a]){c.push(d[a])}}b.$("#"+e).val(c.join(","))};if(!vizus.cms.form.link){vizus.cms.form.link={}}vizus.cms.form.link.select=function(b,a){$("#"+b).val(a);$("#"+b+"Link").text(a);$("#"+b+"None").hide()};vizus.cms.form.link.remove=function(a){$("#"+a).val("");$("#"+a+"Link").empty();$("#"+a+"None").show()};if(!vizus.cms.form.html){vizus.cms.form.html={}}vizus.cms.form.html.view=function(a){$("#"+a).hide();$("#"+a+"Preview").show()};vizus.cms.form.html.source=function(a){$("#"+a).show();$("#"+a+"Preview").hide()};vizus.cms.form.html.onchange=function(a){$("#"+a+"Preview > iframe").get(0).contentWindow.document.location.reload()};vizus.cms.form.html.preview=function(b,c,a){vizus.cms.dialog.open(b,c,a,{autoSize:true,autoResize:true,autoVisible:true,overflowX:"auto",overflowY:"scroll"})};vizus.cms.form.html.web=function(b,c,a){vizus.cms.dialog.open(b,c,a,{autoSize:false,autoResize:true,autoVisible:true,overflowX:"auto",overflowY:"scroll"})};vizus.cms.form.html.edit=function(b,c,a){vizus.cms.dialog.open(b,c,a,{autoSize:false,autoResize:true,autoVisible:true,overflowX:"hidden",overflowY:"hidden"})};if(!vizus.cms.form.htmlStencil){vizus.cms.form.htmlStencil={}}vizus.cms.form.htmlStencil.change=function(g){var b=document.getElementById(g).value;var e=window[g+"Stencils"][b];var f=window[g+"ApplyTo"];function d(h,j){return j.replace(/\bstencil=\d+/,"stencil="+e.id)}function a(h,j){return j.replace(/\bstencil=\d+/,"stencil="+e.id).replace(/, \d+, \d+/,", "+e.width+", "+e.height)}for(var c=0;c<f.length;c++){$("#"+f[c]+"EditLink").attr("href",d);$("#"+f[c]+"WebLink").attr("href",a);$("#"+f[c]+"PreviewLink").attr("href",a);$("#"+f[c]+"PreviewFrame").attr("src",d)}};if(!vizus.cms.form.itemList){vizus.cms.form.itemList={}}vizus.cms.form.itemList.onkeydown=function(b,c){b=b||window.event;var a=vizus.event.keys;switch(b.keyCode){case a.keyPageUp:vizus.cms.form.itemList.jump(c,-10);break;case a.keyPageDown:vizus.cms.form.itemList.jump(c,10);break;case a.keyUp:vizus.cms.form.itemList.up(c);break;case a.keyDown:vizus.cms.form.itemList.down(c);break;case a.keyHome:vizus.cms.form.itemList.first(c);break;case a.keyEnd:vizus.cms.form.itemList.last(c);break;case a.keyDelete:vizus.cms.form.itemList.remove(c);return;default:return}vizus.event.stop(b);return false};vizus.cms.form.itemList.select=function(f,e,d,b){var a=vizus.dom.get(f+"Order");if(!b||a.options.length<b){var c=document.createElement("OPTION");c.value=e;c.selected=true;c.appendChild(document.createTextNode(d));a.appendChild(c);c=c.cloneNode(true);c.selected=true;document.getElementById(f).appendChild(c);vizus.cms.form.itemList.updateActions(f)}};vizus.cms.form.itemList.unselect=function(d,c){var a=vizus.dom.get(d+"Order");for(var b=0;b<a.options.length;b++){if(a.options[b].value==c){vizus.dom.remove(a.options[b]);vizus.cms.form.itemList.update(d);break}}};vizus.cms.form.itemList.add=function(h,d,g,b,c){var a=vizus.dom.get(h+"Order");if(!c||a.options.length<c){var f=[];for(var e=0;e<a.options.length;e++){f.push(a.options[e].value)}d+="&paramSelectedIds="+encodeURIComponent(f.join(","));vizus.cms.dialog.page(d,g,b)}};vizus.cms.form.itemList.first=function(c){var a=vizus.dom.get(c+"Order");if(a.selectedIndex>0){var b=vizus.dom.moveTo(a.options[a.selectedIndex],0);vizus.cms.form.itemList.update(c,b)}};vizus.cms.form.itemList.jump=function(d,b){var a=vizus.dom.get(d+"Order");if(a.selectedIndex!=-1){var c=vizus.dom.moveBy(a.options[a.selectedIndex],b);vizus.cms.form.itemList.update(d,c)}};vizus.cms.form.itemList.up=function(c){var a=vizus.dom.get(c+"Order");if(a.selectedIndex>0){var b=vizus.dom.moveBy(a.options[a.selectedIndex],-1);vizus.cms.form.itemList.update(c,b)}};vizus.cms.form.itemList.down=function(c){var a=vizus.dom.get(c+"Order");if(a.selectedIndex!=-1){var b=vizus.dom.moveBy(a.options[a.selectedIndex],1);vizus.cms.form.itemList.update(c,b)}};vizus.cms.form.itemList.last=function(c){var a=vizus.dom.get(c+"Order");if(a.selectedIndex!=-1){var b=vizus.dom.moveTo(a.options[a.selectedIndex],-1);vizus.cms.form.itemList.update(c,b)}};vizus.cms.form.itemList.remove=function(b){var a=vizus.dom.get(b+"Order");if(a.selectedIndex!=-1){vizus.dom.remove(a.options[a.selectedIndex]);vizus.cms.form.itemList.update(b)}};vizus.cms.form.itemList.update=function(b,a){$("#"+b).empty();$("#"+b+"Order > option").clone().attr("selected",true).appendTo("#"+b);vizus.cms.form.itemList.updateActions(b);if(/firefox/i.test(window.navigator.userAgent)&&a){window.setTimeout(function(){a.selected=true},1)}};vizus.cms.form.itemList.updateActions=function(c,b){var a=$("#"+c+"Order").get(0);if(a.selectedIndex==-1){$("#"+c+"Up").addClass("disabled");$("#"+c+"Down").addClass("disabled");$("#"+c+"Remove").addClass("disabled")}else{if(a.selectedIndex==0){$("#"+c+"Up").addClass("disabled");$("#"+c+"Down").removeClass("disabled");$("#"+c+"Remove").removeClass("disabled")}else{if(a.selectedIndex==a.options.length-1){$("#"+c+"Up").removeClass("disabled");$("#"+c+"Down").addClass("disabled");$("#"+c+"Remove").removeClass("disabled")}else{$("#"+c+"Up").removeClass("disabled");$("#"+c+"Down").removeClass("disabled");$("#"+c+"Remove").removeClass("disabled")}}}if(!b||a.options.length<b){$("#"+c+"Add").removeClass("disabled")}else{$("#"+c+"Add").addClass("disabled")}};if(!vizus.cms.form.views){vizus.cms.form.views={}}vizus.cms.form.views.select=function(b,a){$("#"+b+"List tr.selected").removeClass("selected");$("#"+b+"Views > div.selected").removeClass("selected");$("#"+b+"Row"+a).addClass("selected");$("#"+b+"View"+a).addClass("selected");window[b+"Selected"]=window.document.getElementById(b+"Row"+a)};if(!vizus.cms.dialog){vizus.cms.dialog={}}vizus.cms.dialog.open=function(c,d,a,b,e){b=b||{};b.width=d;b.height=a;b.autoVisible=true;new vizus.cms.dialog.Dialog(c,b,e,window,top)};vizus.cms.dialog.page=function(c,d,a,b,e){b=b||{};b.width=d;b.height=a;b.overflowX="auto";b.overflowY="scroll";b.autoResize=true;b.autoVisible=true;new vizus.cms.dialog.Dialog(c,b,e,window,top)};vizus.cms.dialog.preview=function(c,d,a,b,e){b=b||{};b.width=d||320;b.height=a||240;b.overlay="dark";b.autoSize=true;b.autoRatio=true;b.autoResize=true;b.autoVisible=true;b.autoShrink=true;new vizus.cms.dialog.Dialog(c,b,e,window,top)};vizus.cms.dialog.resolve=function(a){a=a||window;var b=a.name.match(/^dialog(\d+)$/);if(b&&top.vizus.cms.status.dialogInstances[b[1]]){return top.vizus.cms.status.dialogInstances[b[1]]}else{return null}};vizus.cms.dialog.Dialog=function(b,a,e,d,c){this.url=b||"";this.options=a||{};this.data=e||{};this.opener=d||window;this.context=c||top;this.options.x="x" in this.options?this.options.x:null;this.options.y="y" in this.options?this.options.y:null;this.options.width="width" in this.options?this.options.width:null;this.options.height="height" in this.options?this.options.height:null;this.options.overlay="overlay" in this.options?this.options.overlay:"light";this.options.overflowX="overflowX" in this.options?this.options.overflowX:"hidden";this.options.overflowY="overflowY" in this.options?this.options.overflowY:"hidden";this.options.autoSize="autoSize" in this.options?this.options.autoSize:false;this.options.autoResize="autoResize" in this.options?this.options.autoResize:false;this.options.autoRatio="autoRatio" in this.options?this.options.autoRatio:false;this.options.autoVisible="autoVisible" in this.options?this.options.autoVisible:false;this.options.autoShrink="autoShrink" in this.options?this.options.autoShrink:false;this.stack=top.vizus.cms.status.dialogInstances;this.stack.push(this);this.index=this.stack.length-1;this.overlay=new vizus.cms.page.Overlay(this.options.overlay,top);this.visible=false;this.x=this.options.x;this.y=this.options.y;this.width=this.options.width;this.height=this.options.height;this.id="Dialog"+this.index;this.dialog=this.context.$("#Dialog").clone();this.dialog.attr("id",this.id);this.dialog.css({zIndex:this.context.vizus.cms.status.zIndex++,display:"table"});this.dialog.find("h1").draggable(this.dialog);this.dialog.find("a").on("click",this.close.bind(this)).attr("href","javascript:");this.frame=this.dialog.find("iframe");this.frame.attr({src:this.url,name:"dialog"+this.index}).css({overflowX:this.options.overflowX,overflowY:this.options.overflowY});this.dialog.appendTo(this.context.document.body);this.viewport={width:this.context.innerWidth,height:this.context.innerHeight};this.content={width:this.options.width,height:this.options.height,window:this.frame.get(0).contentWindow};this.margin={width:this.dialog.outerWidth(true)-this.dialog.width(),height:this.dialog.outerHeight(true)-this.dialog.height()};this.content.window.close=this.close.bind(this);this.content.window.opener=this.opener;this.onclose=null;if(this.options.width>0&&this.options.height>0){this.resizeTo(this.options.width,this.options.height);if(this.options.autoShrink){this.shrink()}this.moveTo(this.options.x,this.options.y);this.centre(this.options.x===null,this.options.y===null);this.show()}var f=function(){if(!this.visible){var h=this;window.setTimeout(function(){h.init(h.content.window)},500)}};$(this.frame).on("load",f.bind(this));var g=function(){this.viewport={width:this.context.innerWidth,height:this.context.innerHeight};if(this.options.autoResize){this.resizeTo(this.content.width,this.content.height)}if(this.options.autoShrink){this.shrink()}this.centre(this.options.x===null,this.options.y===null)};$(this.context).on("resize.vizus.cms."+this.id,g.bind(this))};vizus.cms.dialog.Dialog.prototype.init=function(c){var e=c.document;var b=e.body.parentNode;var a=$(e.body);a.addClass("dialog").css({overflowX:this.options.overflowX,overflowY:this.options.overflowY});if(this.options.overflowX=="hidden"){$(b).css({overflowX:"hidden"})}if(this.options.overflowY=="hidden"){$(b).css({overflowY:"hidden"})}if(!this.options.width||!this.options.height||this.options.autoSize){a.addClass("flexible");this.frame.width(10).height(10);this.content.width=Math.max(a.outerWidth(true)+($(b).outerWidth(true)-$(b).width()),e.body.scrollWidth);this.content.height=Math.max(a.outerHeight(true)+($(b).outerHeight(true)-$(b).height()),e.body.scrollHeight);if(this.options.overflowX=="auto"||this.options.overflowX=="scroll"){this.content.width+=30}if(this.options.overflowY=="auto"||this.options.overflowY=="scroll"){this.content.height+=30}this.resizeTo(this.content.width,this.content.height);this.moveTo(this.options.x,this.options.y);this.centre(this.options.x===null,this.options.y===null);if(this.options.autoShrink){this.shrink()}this.show()}else{a.addClass("fixed")}var d=function(f){if(vizus.event.keyCode(f.originalEvent)==vizus.event.keys.keyEsc){this.close()}};$(e).on("keydown.vizus.cms."+this.id,d.bind(this));c.setTimeout("window.focus();",100);c.opener=this.opener;c.close=this.close.bind(this);return this};vizus.cms.dialog.Dialog.prototype.centre=function(a,b){if(a){this.x=Math.round(this.context.innerWidth/2-(this.width+this.margin.width)/2)}if(b){this.y=Math.round(this.context.innerHeight/2-(this.height+this.margin.height)/2)}this.dialog.css({left:this.x+"px",top:this.y+"px"});return this};vizus.cms.dialog.Dialog.prototype.moveTo=function(a,b){if(typeof a=="number"){this.dialog.css({left:(this.x=a)+"px"})}if(typeof b=="number"){this.dialog.css({top:(this.y=b)+"px"})}return this};vizus.cms.dialog.Dialog.prototype.resizeTo=function(b,a){if(this.options.autoVisible&&b>0&&a>0){if(b+this.margin.width>this.viewport.width){var d=this.viewport.width-this.margin.width;if(this.options.autoRatio){a=Math.round(a/(b/d))}b=d}if(a+this.margin.height>this.viewport.height){var c=this.viewport.height-this.margin.height;if(this.options.autoRatio){b=Math.round(b/(a/c))}a=c}}if(b>0){this.frame.width(this.width=b)}if(a>0){this.frame.height(this.height=a)}return this};vizus.cms.dialog.Dialog.prototype.shrink=function(){$(this.content.window.document).find("body > img, embed, object, body > div.video-js").css({width:this.width+"px",height:this.height+"px",display:"block"})};vizus.cms.dialog.Dialog.prototype.show=function(){this.dialog.css({visibility:"visible"});this.visible=true;return this};vizus.cms.dialog.Dialog.prototype.title=function(a){if(a==undefined){return this.dialog.find("h1").text()}this.dialog.find("h1").text(a);return this};vizus.cms.dialog.Dialog.prototype.close=function(){if(typeof this.onclose!="function"||this.onclose()!==false){this.remove()}};vizus.cms.dialog.Dialog.prototype.remove=function(){$(this.context).off("resize.vizus.cms."+this.id);$(this.context.document).off("keydown.vizus.cms."+this.id);this.stack.splice(this.index,1);this.dialog.remove();this.overlay.remove();this.context.vizus.cms.status.zIndex--};if(!vizus.cms.editor){vizus.cms.editor={}}if(!vizus.cms.editor.margins){vizus.cms.editor.margins={}}vizus.cms.editor.margins.load=function(d,b,c){var a=window.document.getElementById.bind(window.document);if(b){a(d+"Top").value=b.style.marginTop!=""?parseInt(b.style.marginTop,10):"";a(d+"Right").value=b.style.marginRight!=""?parseInt(b.style.marginRight,10):"";a(d+"Bottom").value=b.style.marginBottom!=""?parseInt(b.style.marginBottom,10):"";a(d+"Left").value=b.style.marginLeft!=""?parseInt(b.style.marginLeft,10):""}else{a(d+"Top").value=c.top;a(d+"Right").value=c.right;a(d+"Bottom").value=c.bottom;a(d+"Left").value=c.left}};vizus.cms.editor.margins.save=function(c,a){a=a||"cms.editor";var b=window.document.getElementById.bind(window.document);document.cookie="CmsUserSessionSettings["+a+".marginTop]="+b(c+"Top").value;document.cookie="CmsUserSessionSettings["+a+".marginLeft]="+b(c+"Left").value;document.cookie="CmsUserSessionSettings["+a+".marginRight]="+b(c+"Right").value;document.cookie="CmsUserSessionSettings["+a+".marginBottom]="+b(c+"Bottom").value};if(!vizus.cms.editor.file){vizus.cms.editor.file={}}vizus.cms.editor.file.enter=function(b,a){window.opener.vizus.cms.editor.file.select(b,a);if(window.dialog!=undefined&&window.dialog.close!=undefined){window.dialog.close()}else{window.close()}};vizus.cms.editor.file.select=function(c,b){var a=window[c];if(typeof a.onselect=="function"){a.onselect.call(a,c)}$("#"+c+"Link").hide();$("#"+c+"Info").hide();$("#"+c+"None").show();if(b){vizus.cms.page.wait();document.getElementById(c+"Loader").src=vizus.url.replace(a.infoUrl,{query:{archiveID:b}})}};vizus.cms.editor.file.load=function(c){var a=document.getElementById(c+"Loader").contentWindow;var b=window[c];b.file=a.file;b.images=a.images;if(b.file){$("#"+c+"Browser").html(b.browserLink.replace("FOLDER_ID",b.file.folderId));$("#"+c+"Link").html(b.file.link).show();$("#"+c+"Info").html("("+b.file.size+", "+b.file.created+")").show();$("#"+c+"None").hide();if(typeof b.onload=="function"){b.onload.call(b,c)}}vizus.cms.page.wait(false)};if(!vizus.cms.editor.tinymce){vizus.cms.editor.tinymce={}}vizus.cms.editor.tinymce.getLinkData=function(d){var c=d.selection.getNode();var b=d.selection.getContent();var a=d.dom.getParent(c,"a[href]");var e={anchor:a,onlyText:!(/</.test(b)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(b)||b.indexOf("href=")==-1)),text:a?(a.innerText||a.textContent):d.selection.getContent({format:"text"}),href:a?d.dom.getAttrib(a,"href"):"",target:a?d.dom.getAttrib(a,"target"):(d.settings.default_link_target||null),rel:a?d.dom.getAttrib(a,"rel"):null,title:a?d.dom.getAttrib(a,"title"):"",className:a?d.dom.getAttrib(a,"class"):null,attrs:[]};return e};vizus.cms.editor.tinymce.insertLink=function(c,d){var a={href:d.href?d.href:null,target:d.target?d.target:null,rel:d.rel?d.rel:null,title:d.title?d.title:null,"class":d.className?d.className:null};if(d.attrs){for(var b in d.attrs){a[b]=d.attrs[b]}}if(d.anchor){c.focus();if(d.onlyText){$(d.anchor).text(d.text)}c.dom.setAttribs(d.anchor,a);c.selection.select(d.anchor);c.undoManager.add()}else{if(d.onlyText){c.insertContent(c.dom.createHTML("a",a,c.dom.encode(d.text)))}else{c.execCommand("mceInsertLink",false,a)}}};if(!vizus.cms.archive){vizus.cms.archive={}}if(!vizus.cms.archive.move){vizus.cms.archive.move={}}vizus.cms.archive.move.ondragstart=function(a){var b=a.target;if($(b).find("input.selected:checked").length==0){vizus.cms.wcom.listTile.select(b.id)}vizus.cms.dragdrop.ondragstart(a)};vizus.cms.archive.move.ondrop=function(c){c.preventDefault();var f=c.dataTransfer.getData("Text");var e=c.currentTarget;if(f){var d=vizus.dom.get(f);if(d!==e){var a=$(d).data("list-select-id");var b=vizus.dom.get(a+"Operation");b.value="move";b.form.action=vizus.url.replace(b.form.action,{query:{targetID:$(e).data("id")}});b.form.submit();vizus.cms.page.wait()}}vizus.dom.removeClass(e,"dragover")};vizus.cms.archive.Uploader=function(e,a,d,c){this.id=e;this.url=a;this.callback=d;this.element=vizus.dom.get(this.id);this.element.innerHTML='<span class="message"></span><span class="complete"></span><span class="progress"></span>';this.xhr=null;c=c||{};this.messages={};this.messages.wait=c.wait||vizus.i18n.text("Nové soubory přetáhněte myší sem");this.messages.dragover=c.dragover||"";this.messages.uploading=c.uploading||vizus.i18n.text("Nahrávání, čekejte...");this.messages.processing=c.processing||vizus.i18n.text("Zpracovávání, čekejte...");this.messages.nofile=c.nofile||vizus.i18n.text("Žádný soubor k nahrání");this.messages.onerror=c.onerror||vizus.i18n.text("Chyba při nahrávání souboru");this.messages.ontimeout=c.ontimeout||vizus.i18n.text("Vypršel časový limit");this.$element=$(this.element);this.$message=this.$element.find("span.message").eq(0);this.$complete=this.$element.find("span.complete").eq(0);this.$progress=this.$element.find("span.progress").eq(0);this.$percent=[];for(var b=10;b<=100;b+=10){this.$percent[b]=$('<span class="percent-'+b+'"></span>');this.$progress.append(this.$percent[b])}this.state("wait")};vizus.cms.archive.Uploader.prototype.state=function(a){if(!a){return this.status}if(a==this.status){return}var d=this;function c(){d.element.ondragover=d.ondragover.bind(d);d.element.ondragleave=d.ondragleave.bind(d);d.element.ondrop=d.ondrop.bind(d)}function b(){d.element.ondragover=null;d.element.ondragleave=null;d.element.ondrop=null}function e(){window.setTimeout(function(){d.state("wait")},5000)}switch(a){case"wait":c();break;case"dragover":break;case"uploading":b();break;case"processing":b();break;case"done":b();e();break;case"error":b();e();break}this.$element.removeClass("wait dragover uploading processing done error").addClass(a);this.message(this.messages[a]);this.status=a};vizus.cms.archive.Uploader.prototype.upload=function(d){var e=new FormData();var c=d.dataTransfer.files;var b=0;for(var a=0;a<c.length;a++){if(c[a].size>0){e.append("file"+a,c[a]);b+=c[a].size}}if(b==0){this.error(this.messages.nofile);return false}this.progress(0);this.state("uploading");this.xhr=new XMLHttpRequest();this.xhr.open("POST",this.url,true);this.xhr.onerror=this.onerror.bind(this);this.xhr.ontimeout=this.ontimeout.bind(this);this.xhr.onload=this.onload.bind(this);this.xhr.upload.onprogress=this.onprogress.bind(this);this.xhr.send(e)};vizus.cms.archive.Uploader.prototype.progress=function(a){for(var b=10;b<=100;b+=10){this.$percent[b].toggleClass("shown",b<=a)}this.$complete.text(a+"%")};vizus.cms.archive.Uploader.prototype.message=function(a){this.$message.text(a||"")};vizus.cms.archive.Uploader.prototype.error=function(a){this.state("error");this.message(a)};vizus.cms.archive.Uploader.prototype.ondragover=function(a){this.state("dragover");return false};vizus.cms.archive.Uploader.prototype.ondragleave=function(a){this.state("wait");return false};vizus.cms.archive.Uploader.prototype.ondrop=function(a){a.preventDefault();this.upload(a)};vizus.cms.archive.Uploader.prototype.onload=function(d){var a=null;var c=this;function b(e){if(c.callback){window.setTimeout(function(){c.callback(c.id,a)},e)}}try{a=JSON.parse(this.xhr.response);if(a.number){this.progress(100);this.state("done");this.message(a.result);b(500)}else{this.error(a.result);b(5000)}}catch(f){this.error(this.messages.onerror);b(5000)}};vizus.cms.archive.Uploader.prototype.onprogress=function(b){if(b.lengthComputable){var a=Math.round(b.loaded/b.total*100|0);this.progress(a);if(a==100){this.state("processing")}}};vizus.cms.archive.Uploader.prototype.onerror=function(a){this.error(this.messages.onerror)};vizus.cms.archive.Uploader.prototype.ontimeout=function(a){this.error(this.messages.ontimeout)};if(!vizus.cms.dragdrop){vizus.cms.dragdrop={}}vizus.cms.dragdrop.addDrag=function(e,d,a,f){for(var c=0;c<e.length;c++){var b=vizus.dom.get(e[c]);b.draggable=true;b.ondrag=d||null;b.ondragstart=a||vizus.cms.dragdrop.ondragstart;b.ondragend=f||null;$(b).find("*").each(function(){this.draggable=false})}};vizus.cms.dragdrop.disableDrop=function(a){a=vizus.dom.get(a);if($(a).hasClass("dropzone")){a.disabledDrop={ondrop:a.ondrop,ondragenter:a.ondragenter,ondragover:a.ondragover,ondragleave:a.ondragleave};a.ondrop=null;a.ondragenter=null;a.ondragover=null;a.ondragleave=null;vizus.dom.removeClass(a,"dropzone")}};vizus.cms.dragdrop.enableDrop=function(a){a=vizus.dom.get(a);if(a.disabledDrop){a.ondrop=a.disabledDrop.ondrop;a.ondragenter=a.disabledDrop.ondragenter;a.ondragover=a.disabledDrop.ondragover;a.ondragleave=a.disabledDrop.ondragleave;a.disabledDrop=null;vizus.dom.addClass(a,"dropzone")}};vizus.cms.dragdrop.addDrop=function(g,b,a,e,f){for(var d=0;d<g.length;d++){var c=vizus.dom.get(g[d]);c.ondrop=b||vizus.cms.dragdrop.ondrop;c.ondragenter=a||null;c.ondragover=e||vizus.cms.dragdrop.ondragover;c.ondragleave=f||vizus.cms.dragdrop.ondragleave;vizus.dom.addClass(c,"dropzone")}};vizus.cms.dragdrop.ondragover=function(a){vizus.dom.addClass(this,"dragover");return false};vizus.cms.dragdrop.ondragleave=function(a){vizus.dom.removeClass(this,"dragover");return false};vizus.cms.dragdrop.ondragstart=function(a){a.dataTransfer.setData("Text",a.target.id)};vizus.cms.dragdrop.ondrop=function(a){a.preventDefault();var d=a.dataTransfer.getData("Text");var c=a.currentTarget;if(d){var b=vizus.dom.get(d);if(b!==c){if(c.compareDocumentPosition(b)&Node.DOCUMENT_POSITION_FOLLOWING){c.parentNode.insertBefore(b,c)}else{c.parentNode.insertBefore(b,c.nextSibling)}}}vizus.dom.removeClass(c,"dragover")};vizus.cms.player=function(b){if(!vizus.isClassOf(b,["String","HTMLVideoElement","HTMLAudioElement"])){return}if(typeof videojs=="function"){videojs(b,{plugins:{VizusAddOns:{element:b}}})}else{var c=vizus.cms.config.baseUrl+"player/";var a=1;vizus.page.addCss(c+"skin.css?version="+a);vizus.page.addJs(c+"vjs.js?version="+a,function(){vizus.page.addJs(c+"localize.js?version="+a,function(){videojs.options.flash.swf=c+"vjs.swf?version="+a;videojs.plugin("VizusAddOns",function(d){var i=this.controlBar.getChild("playToggle").el();var k=this.controlBar.getChild("remainingTimeDisplay").el();var g=this.controlBar.getChild("muteToggle").el();var f=this.currentSrc().match(/\.(\w{3,4})($|\?)/)[1];var h=document.createElement("div");h.className="vjs-control vjs-source-format";h.innerHTML=f?f.toUpperCase():"";k.parentNode.insertBefore(h,k);var j=document.createElement("div");j.className="vjs-control vjs-source-title";j.innerHTML=vizus.dom.get(d.element).getAttribute("title")||"";j.style.display="none";k.parentNode.insertBefore(j,k);function e(){j.style.display="none";var l=g.getBoundingClientRect();var o=h.getBoundingClientRect();var n=i.getBoundingClientRect();var m=l.left-o.right-30;if(m>20&&n.top==l.top){j.style.width=m+"px";j.style.display="block"}}this.on("resize",e);this.on("firstplay",e);this.on("fullscreenchange",e);e()});vizus.cms.player(b)})})}};if(typeof vizus.cms.config!="object"){vizus.cms.config={}}if(typeof vizus.cms.config.baseUrl!="string"){vizus.cms.config.baseUrl=vizus.page.getJsSrc(/^(.+?\/cms\/3\.0\/)(cms|web)(\.src)?\.js/,1)};